<!doctype html>
<html lang="id">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dungeon Sejarah</title>
  <script src="/_sdk/element_sdk.js"></script>
  <style>
    body {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: 'Courier New', monospace;
      background: #1a1a2e;
      color: #eee;
      overflow: hidden;
      height: 100%;
    }

    html {
      height: 100%;
    }

    .game-container {
      width: 100%;
      height: 100%;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 20px;
      background: linear-gradient(180deg, #0f0f1e 0%, #1a1a2e 100%);
    }

    .screen {
      display: none;
      width: 100%;
      max-width: 800px;
      text-align: center;
    }

    .screen.active {
      display: block;
    }

    .title {
      font-size: 48px;
      font-weight: bold;
      margin-bottom: 20px;
      text-shadow: 4px 4px 0px #000;
      color: #ffd700;
      image-rendering: pixelated;
    }

    .subtitle {
      font-size: 20px;
      margin-bottom: 30px;
      color: #aaa;
    }

    .btn {
      background: #ff6b6b;
      color: white;
      border: 4px solid #000;
      padding: 15px 40px;
      font-size: 20px;
      font-family: 'Courier New', monospace;
      cursor: pointer;
      text-transform: uppercase;
      box-shadow: 4px 4px 0px #000;
      transition: all 0.1s;
      margin: 10px;
    }

    .btn:hover {
      background: #ff5252;
      transform: translate(2px, 2px);
      box-shadow: 2px 2px 0px #000;
    }

    .btn:active {
      transform: translate(4px, 4px);
      box-shadow: 0px 0px 0px #000;
    }

    .dungeon-stage {
      background: #2d2d44;
      border: 6px solid #000;
      padding: 30px;
      margin: 20px 0;
      box-shadow: 8px 8px 0px #000;
      position: relative;
      overflow: hidden;
      min-height: 500px;
    }

    /* Progress Path Container */
    .progress-path {
      position: absolute;
      top: 20px;
      left: 50%;
      transform: translateX(-50%);
      width: 90%;
      max-width: 700px;
      height: 120px;
      z-index: 1;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    /* Path Line */
    .path-line {
      position: absolute;
      top: 50%;
      left: 5%;
      right: 5%;
      height: 8px;
      background: repeating-linear-gradient(
        90deg,
        #4a4a62 0px,
        #4a4a62 15px,
        #3a3a52 15px,
        #3a3a52 20px
      );
      border: 3px solid #000;
      transform: translateY(-50%);
      box-shadow: 0 4px 0 rgba(0,0,0,0.5);
    }

    /* Stage Node */
    .stage-node {
      position: relative;
      width: 60px;
      height: 60px;
      z-index: 2;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 8px;
    }

    /* Door/Gate Icon */
    .stage-door {
      width: 48px;
      height: 56px;
      background: #1a1a2e;
      border: 4px solid #000;
      border-radius: 24px 24px 0 0;
      position: relative;
      box-shadow: 
        inset 0 0 15px rgba(0,0,0,0.8),
        4px 4px 0 rgba(0,0,0,0.5);
      transition: all 0.3s ease;
    }

    /* Door bars */
    .stage-door::before {
      content: '';
      position: absolute;
      width: 100%;
      height: 60%;
      top: 0;
      left: 0;
      background: repeating-linear-gradient(
        0deg,
        #4a4a62 0px,
        #4a4a62 6px,
        #3a3a52 6px,
        #3a3a52 8px
      );
      border-radius: 24px 24px 0 0;
    }

    /* Lock Icon */
    .stage-lock {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 20px;
      height: 16px;
      background: #8b4513;
      border: 3px solid #000;
      border-radius: 3px;
      box-shadow: inset 0 -3px 0 rgba(0,0,0,0.3);
    }

    .stage-lock::before {
      content: '';
      position: absolute;
      width: 16px;
      height: 12px;
      border: 3px solid #8b4513;
      border-bottom: none;
      border-radius: 8px 8px 0 0;
      top: -12px;
      left: 50%;
      transform: translateX(-50%);
      background: transparent;
    }

    .stage-lock::after {
      content: '';
      position: absolute;
      width: 6px;
      height: 6px;
      background: #000;
      border-radius: 50%;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
    }

    /* Unlocked state */
    .stage-node.unlocked .stage-door {
      background: #2d4a2d;
      box-shadow: 
        inset 0 0 15px rgba(81, 207, 102, 0.3),
        4px 4px 0 rgba(0,0,0,0.5),
        0 0 20px rgba(81, 207, 102, 0.4);
    }

    .stage-node.unlocked .stage-lock {
      background: #51cf66;
      animation: unlockShine 2s ease-in-out infinite;
    }

    @keyframes unlockShine {
      0%, 100% { 
        box-shadow: inset 0 -3px 0 rgba(0,0,0,0.3);
      }
      50% { 
        box-shadow: 
          inset 0 -3px 0 rgba(0,0,0,0.3),
          0 0 15px rgba(81, 207, 102, 0.8);
      }
    }

    /* Current/Active state */
    .stage-node.current .stage-door {
      background: #4a2d2d;
      animation: currentDoorPulse 1.5s ease-in-out infinite;
    }

    @keyframes currentDoorPulse {
      0%, 100% { 
        box-shadow: 
          inset 0 0 15px rgba(255, 107, 107, 0.3),
          4px 4px 0 rgba(0,0,0,0.5),
          0 0 20px rgba(255, 107, 107, 0.5);
      }
      50% { 
        box-shadow: 
          inset 0 0 15px rgba(255, 107, 107, 0.5),
          4px 4px 0 rgba(0,0,0,0.5),
          0 0 30px rgba(255, 107, 107, 0.8);
      }
    }

    .stage-node.current .stage-lock {
      background: #ff6b6b;
      animation: currentLockGlow 1.5s ease-in-out infinite;
    }

    @keyframes currentLockGlow {
      0%, 100% { 
        box-shadow: 
          inset 0 -3px 0 rgba(0,0,0,0.3),
          0 0 10px rgba(255, 107, 107, 0.6);
      }
      50% { 
        box-shadow: 
          inset 0 -3px 0 rgba(0,0,0,0.3),
          0 0 20px rgba(255, 107, 107, 1);
      }
    }

    /* Stage number label */
    .stage-number {
      font-size: 12px;
      font-weight: bold;
      color: #aaa;
      text-shadow: 1px 1px 0 #000;
      background: #1a1a2e;
      border: 2px solid #000;
      padding: 2px 8px;
      border-radius: 3px;
      min-width: 30px;
      text-align: center;
    }

    .stage-node.unlocked .stage-number {
      color: #51cf66;
      background: #1a2e1a;
      border-color: #51cf66;
    }

    .stage-node.current .stage-number {
      color: #ff6b6b;
      background: #2e1a1a;
      border-color: #ff6b6b;
      animation: numberPulse 1.5s ease-in-out infinite;
    }

    @keyframes numberPulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.1); }
    }

    /* Dinding batu */
    .stone-wall {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: 
        repeating-linear-gradient(
          0deg,
          #3a3a52 0px,
          #3a3a52 40px,
          #2d2d44 40px,
          #2d2d44 42px
        ),
        repeating-linear-gradient(
          90deg,
          #3a3a52 0px,
          #3a3a52 60px,
          #2d2d44 60px,
          #2d2d44 62px
        );
      z-index: 0;
    }

    /* Batu individual */
    .stone-block {
      position: absolute;
      width: 50px;
      height: 35px;
      background: #4a4a62;
      border: 2px solid #000;
      box-shadow: inset 2px 2px 0 rgba(255,255,255,0.1), inset -2px -2px 0 rgba(0,0,0,0.3);
    }

    .stone-block:nth-child(1) { top: 20px; left: 20px; }
    .stone-block:nth-child(2) { top: 20px; right: 20px; }
    .stone-block:nth-child(3) { top: 60px; left: 80px; }
    .stone-block:nth-child(4) { top: 60px; right: 80px; }
    .stone-block:nth-child(5) { bottom: 20px; left: 40px; }
    .stone-block:nth-child(6) { bottom: 20px; right: 40px; }

    /* Obor kiri */
    .torch-left {
      position: absolute;
      top: 30px;
      left: 30px;
      width: 12px;
      height: 40px;
      background: #654321;
      border: 2px solid #000;
      z-index: 2;
    }

    .torch-left::before {
      content: '';
      position: absolute;
      top: -15px;
      left: 50%;
      transform: translateX(-50%);
      width: 20px;
      height: 20px;
      background: #ff6b35;
      border-radius: 50% 50% 50% 50% / 60% 60% 40% 40%;
      box-shadow: 0 0 20px #ff6b35, 0 0 30px #ff4500;
      animation: flameFlicker 1.5s infinite;
    }

    .torch-left::after {
      content: '';
      position: absolute;
      top: -20px;
      left: 50%;
      transform: translateX(-50%);
      width: 12px;
      height: 15px;
      background: #ffd700;
      border-radius: 50% 50% 50% 50% / 60% 60% 40% 40%;
      animation: flameFlicker 1.5s infinite 0.3s;
    }

    /* Obor kanan */
    .torch-right {
      position: absolute;
      top: 30px;
      right: 30px;
      width: 12px;
      height: 40px;
      background: #654321;
      border: 2px solid #000;
      z-index: 2;
    }

    .torch-right::before {
      content: '';
      position: absolute;
      top: -15px;
      left: 50%;
      transform: translateX(-50%);
      width: 20px;
      height: 20px;
      background: #ff6b35;
      border-radius: 50% 50% 50% 50% / 60% 60% 40% 40%;
      box-shadow: 0 0 20px #ff6b35, 0 0 30px #ff4500;
      animation: flameFlicker 1.5s infinite 0.5s;
    }

    .torch-right::after {
      content: '';
      position: absolute;
      top: -20px;
      left: 50%;
      transform: translateX(-50%);
      width: 12px;
      height: 15px;
      background: #ffd700;
      border-radius: 50% 50% 50% 50% / 60% 60% 40% 40%;
      animation: flameFlicker 1.5s infinite 0.8s;
    }

    @keyframes flameFlicker {
      0%, 100% { 
        transform: translateX(-50%) scale(1);
        opacity: 1;
      }
      25% { 
        transform: translateX(-50%) scale(1.1, 0.9);
        opacity: 0.9;
      }
      50% { 
        transform: translateX(-50%) scale(0.9, 1.1);
        opacity: 1;
      }
      75% { 
        transform: translateX(-50%) scale(1.05, 0.95);
        opacity: 0.95;
      }
    }

    /* Pintu gerbang */
    .dungeon-gate {
      position: absolute;
      bottom: 20px;
      right: 30px;
      width: 60px;
      height: 80px;
      background: #1a1a2e;
      border: 4px solid #000;
      border-radius: 30px 30px 0 0;
      z-index: 2;
      box-shadow: inset 0 0 20px rgba(0,0,0,0.8);
    }

    .dungeon-gate::before {
      content: '';
      position: absolute;
      width: 100%;
      height: 50%;
      top: 0;
      left: 0;
      background: repeating-linear-gradient(
        0deg,
        #4a4a62 0px,
        #4a4a62 8px,
        #3a3a52 8px,
        #3a3a52 10px
      );
      border-radius: 30px 30px 0 0;
    }

    .dungeon-gate::after {
      content: '';
      position: absolute;
      width: 12px;
      height: 12px;
      background: #8b4513;
      border: 2px solid #000;
      border-radius: 50%;
      top: 50%;
      left: 15px;
      transform: translateY(-50%);
    }

    /* Tanda panah di pintu */
    .gate-arrow {
      position: absolute;
      top: 50%;
      right: 10px;
      transform: translateY(-50%);
      width: 0;
      height: 0;
      border-left: 12px solid #ffd700;
      border-top: 8px solid transparent;
      border-bottom: 8px solid transparent;
      animation: arrowPulse 1.5s infinite;
    }

    @keyframes arrowPulse {
      0%, 100% { 
        opacity: 0.6;
        right: 10px;
      }
      50% { 
        opacity: 1;
        right: 15px;
      }
    }

    /* Konten stage di atas background */
    .stage-content {
      position: relative;
      z-index: 1;
      margin-top: 140px;
    }

    /* Trigger Area - Ubin Berkedip */
    .trigger-area {
      position: absolute;
      bottom: 80px;
      left: 50%;
      transform: translateX(-50%);
      width: 120px;
      height: 120px;
      z-index: 0;
    }

    /* Lingkaran cahaya luar */
    .trigger-circle-outer {
      position: absolute;
      width: 100%;
      height: 100%;
      border-radius: 50%;
      background: radial-gradient(
        circle,
        rgba(255, 215, 0, 0.3) 0%,
        rgba(255, 215, 0, 0.1) 50%,
        transparent 70%
      );
      animation: triggerPulseOuter 2s ease-in-out infinite;
    }

    @keyframes triggerPulseOuter {
      0%, 100% {
        transform: scale(1);
        opacity: 0.6;
      }
      50% {
        transform: scale(1.2);
        opacity: 0.3;
      }
    }

    /* Lingkaran cahaya tengah */
    .trigger-circle-middle {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 80%;
      height: 80%;
      border-radius: 50%;
      background: radial-gradient(
        circle,
        rgba(255, 215, 0, 0.5) 0%,
        rgba(255, 215, 0, 0.2) 60%,
        transparent 80%
      );
      animation: triggerPulseMiddle 2s ease-in-out infinite 0.3s;
    }

    @keyframes triggerPulseMiddle {
      0%, 100% {
        transform: translate(-50%, -50%) scale(1);
        opacity: 0.8;
      }
      50% {
        transform: translate(-50%, -50%) scale(1.15);
        opacity: 0.4;
      }
    }

    /* Ubin tengah - platform */
    .trigger-platform {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 80px;
      height: 80px;
      background: #ffd700;
      border: 4px solid #000;
      box-shadow: 
        inset 0 0 20px rgba(255, 215, 0, 0.8),
        0 0 30px rgba(255, 215, 0, 0.6),
        4px 4px 0 rgba(0,0,0,0.5);
      animation: triggerBlink 1.5s ease-in-out infinite;
      image-rendering: pixelated;
    }

    @keyframes triggerBlink {
      0%, 100% {
        background: #ffd700;
        box-shadow: 
          inset 0 0 20px rgba(255, 215, 0, 0.8),
          0 0 30px rgba(255, 215, 0, 0.6),
          4px 4px 0 rgba(0,0,0,0.5);
      }
      50% {
        background: #ffed4e;
        box-shadow: 
          inset 0 0 30px rgba(255, 237, 78, 1),
          0 0 50px rgba(255, 215, 0, 1),
          4px 4px 0 rgba(0,0,0,0.5);
      }
    }

    /* Pola ubin pixel */
    .trigger-platform::before {
      content: '';
      position: absolute;
      width: 100%;
      height: 100%;
      background: 
        repeating-linear-gradient(
          0deg,
          transparent 0px,
          transparent 18px,
          rgba(0,0,0,0.1) 18px,
          rgba(0,0,0,0.1) 20px
        ),
        repeating-linear-gradient(
          90deg,
          transparent 0px,
          transparent 18px,
          rgba(0,0,0,0.1) 18px,
          rgba(0,0,0,0.1) 20px
        );
    }

    /* Simbol di tengah ubin */
    .trigger-platform::after {
      content: '‚ö°';
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      font-size: 32px;
      color: #000;
      text-shadow: 
        0 0 10px rgba(255, 215, 0, 0.8),
        2px 2px 0 rgba(0,0,0,0.3);
      animation: symbolRotate 3s linear infinite;
    }

    @keyframes symbolRotate {
      0% { transform: translate(-50%, -50%) rotate(0deg); }
      100% { transform: translate(-50%, -50%) rotate(360deg); }
    }

    /* Partikel berkilau di sekitar trigger */
    .trigger-sparkles {
      position: absolute;
      width: 100%;
      height: 100%;
      top: 0;
      left: 0;
      pointer-events: none;
    }

    .trigger-sparkle {
      position: absolute;
      width: 6px;
      height: 6px;
      background: #ffd700;
      border-radius: 50%;
      box-shadow: 0 0 8px #ffd700;
      animation: sparkleFloat 2s ease-in-out infinite;
    }

    .trigger-sparkle:nth-child(1) {
      top: 10%;
      left: 20%;
      animation-delay: 0s;
    }

    .trigger-sparkle:nth-child(2) {
      top: 20%;
      right: 15%;
      animation-delay: 0.4s;
    }

    .trigger-sparkle:nth-child(3) {
      bottom: 15%;
      left: 15%;
      animation-delay: 0.8s;
    }

    .trigger-sparkle:nth-child(4) {
      bottom: 20%;
      right: 20%;
      animation-delay: 1.2s;
    }

    .trigger-sparkle:nth-child(5) {
      top: 50%;
      left: 5%;
      animation-delay: 1.6s;
    }

    .trigger-sparkle:nth-child(6) {
      top: 50%;
      right: 5%;
      animation-delay: 2s;
    }

    @keyframes sparkleFloat {
      0%, 100% {
        opacity: 0;
        transform: translateY(0) scale(0.5);
      }
      50% {
        opacity: 1;
        transform: translateY(-15px) scale(1);
      }
    }

    /* Jalan setapak menuju trigger */
    .stone-path {
      position: absolute;
      bottom: 80px;
      left: 50%;
      transform: translateX(-50%);
      width: 100px;
      height: 200px;
      z-index: 0;
    }

    .path-stone {
      position: absolute;
      width: 40px;
      height: 30px;
      background: #5a5a72;
      border: 3px solid #000;
      box-shadow: 
        inset 2px 2px 0 rgba(255,255,255,0.1),
        inset -2px -2px 0 rgba(0,0,0,0.3),
        2px 2px 0 rgba(0,0,0,0.5);
      image-rendering: pixelated;
    }

    .path-stone:nth-child(1) {
      bottom: 120px;
      left: 50%;
      transform: translateX(-50%);
    }

    .path-stone:nth-child(2) {
      bottom: 160px;
      left: 30%;
      transform: translateX(-50%) rotate(-5deg);
    }

    .path-stone:nth-child(3) {
      bottom: 200px;
      left: 60%;
      transform: translateX(-50%) rotate(5deg);
    }

    .path-stone:nth-child(4) {
      bottom: 240px;
      left: 40%;
      transform: translateX(-50%) rotate(-3deg);
    }

    .player-sprite {
      width: 64px;
      height: 64px;
      position: relative;
      margin: 20px auto;
      image-rendering: pixelated;
      transition: all 0.3s ease;
    }

    /* STATUS 1: IDLE/BERDIRI TEGAK */
    .player-sprite.idle {
      animation: playerIdle 1.5s infinite;
    }

    @keyframes playerIdle {
      0%, 100% { transform: translateY(0px); }
      50% { transform: translateY(-6px); }
    }

    /* STATUS 2: WALKING/BERJALAN */
    .player-sprite.walking {
      animation: playerWalk 0.6s infinite;
    }

    @keyframes playerWalk {
      0%, 100% { 
        transform: translateY(0px) translateX(0px);
      }
      25% { 
        transform: translateY(-4px) translateX(-2px);
      }
      50% { 
        transform: translateY(0px) translateX(0px);
      }
      75% { 
        transform: translateY(-4px) translateX(2px);
      }
    }

    /* STATUS 3: VICTORY/MENANG */
    .player-sprite.victory {
      animation: playerVictory 0.8s ease-in-out infinite;
    }

    @keyframes playerVictory {
      0%, 100% { 
        transform: translateY(0px) scale(1);
      }
      50% { 
        transform: translateY(-12px) scale(1.05);
      }
    }

    /* STATUS 4: DEFEAT/KALAH */
    .player-sprite.defeat {
      animation: playerDefeat 0.5s ease-out forwards;
    }

    @keyframes playerDefeat {
      0% { 
        transform: translateY(0px) rotate(0deg);
        opacity: 1;
      }
      50% {
        transform: translateY(-8px) rotate(-10deg);
      }
      100% { 
        transform: translateY(20px) rotate(-90deg);
        opacity: 0.7;
      }
    }

    /* Badan petualang */
    .player-sprite::before {
      content: '';
      position: absolute;
      width: 32px;
      height: 36px;
      background: #8b4513;
      border: 3px solid #000;
      bottom: 0;
      left: 50%;
      transform: translateX(-50%);
      box-shadow: inset 0 -8px 0 rgba(0,0,0,0.2);
      transition: all 0.3s ease;
    }

    /* Kepala dengan helm */
    .player-sprite::after {
      content: '';
      position: absolute;
      width: 28px;
      height: 28px;
      background: #c0c0c0;
      border: 3px solid #000;
      top: 0;
      left: 50%;
      transform: translateX(-50%);
      border-radius: 4px 4px 0 0;
      box-shadow: inset 0 -6px 0 rgba(0,0,0,0.3);
    }

    /* Mata kiri */
    .player-eye-left {
      position: absolute;
      width: 6px;
      height: 6px;
      background: #000;
      top: 12px;
      left: 20px;
      border-radius: 50%;
      transition: all 0.3s ease;
    }

    /* Mata kanan */
    .player-eye-right {
      position: absolute;
      width: 6px;
      height: 6px;
      background: #000;
      top: 12px;
      right: 20px;
      border-radius: 50%;
      transition: all 0.3s ease;
    }

    /* Mata berubah saat menang */
    .player-sprite.victory .player-eye-left,
    .player-sprite.victory .player-eye-right {
      width: 8px;
      height: 4px;
      border-radius: 0 0 50% 50%;
      background: #000;
    }

    /* Mata berubah saat kalah (X) */
    .player-sprite.defeat .player-eye-left,
    .player-sprite.defeat .player-eye-right {
      width: 10px;
      height: 10px;
      background: transparent;
      border: none;
    }

    .player-sprite.defeat .player-eye-left::before,
    .player-sprite.defeat .player-eye-right::before {
      content: '';
      position: absolute;
      width: 10px;
      height: 3px;
      background: #000;
      top: 50%;
      left: 0;
      transform: translateY(-50%) rotate(45deg);
    }

    .player-sprite.defeat .player-eye-left::after,
    .player-sprite.defeat .player-eye-right::after {
      content: '';
      position: absolute;
      width: 10px;
      height: 3px;
      background: #000;
      top: 50%;
      left: 0;
      transform: translateY(-50%) rotate(-45deg);
    }

    /* Pedang mini */
    .player-sword {
      position: absolute;
      width: 4px;
      height: 24px;
      background: #c0c0c0;
      border: 2px solid #000;
      bottom: 8px;
      right: 8px;
      transform: rotate(-45deg);
      transform-origin: bottom;
      transition: all 0.3s ease;
    }

    /* Pedang saat idle */
    .player-sprite.idle .player-sword {
      animation: swordSwing 2s infinite;
    }

    @keyframes swordSwing {
      0%, 100% { transform: rotate(-45deg); }
      50% { transform: rotate(-30deg); }
    }

    /* Pedang saat berjalan */
    .player-sprite.walking .player-sword {
      animation: swordWalk 0.6s infinite;
    }

    @keyframes swordWalk {
      0%, 100% { transform: rotate(-45deg); }
      50% { transform: rotate(-60deg); }
    }

    /* Pedang saat menang - terangkat tinggi */
    .player-sprite.victory .player-sword {
      animation: swordVictory 0.8s ease-in-out infinite;
      right: 50%;
      transform: translateX(50%) rotate(-90deg);
      bottom: 45px;
    }

    @keyframes swordVictory {
      0%, 100% { 
        transform: translateX(50%) rotate(-90deg);
      }
      50% { 
        transform: translateX(50%) rotate(-90deg) translateY(-8px);
      }
    }

    /* Pedang saat kalah - jatuh */
    .player-sprite.defeat .player-sword {
      animation: swordDefeat 0.5s ease-out forwards;
    }

    @keyframes swordDefeat {
      0% { 
        transform: rotate(-45deg);
        opacity: 1;
      }
      100% { 
        transform: rotate(-45deg) translateX(30px) translateY(20px);
        opacity: 0;
      }
    }

    /* Gagang pedang */
    .player-sword::before {
      content: '';
      position: absolute;
      width: 12px;
      height: 4px;
      background: #8b4513;
      border: 2px solid #000;
      bottom: 18px;
      left: 50%;
      transform: translateX(-50%);
    }

    /* Ujung pedang (emas) */
    .player-sword::after {
      content: '';
      position: absolute;
      width: 8px;
      height: 4px;
      background: #ffd700;
      border: 2px solid #000;
      top: -2px;
      left: 50%;
      transform: translateX(-50%);
    }

    /* Hiasan helm (puncak) */
    .player-helmet-top {
      position: absolute;
      width: 8px;
      height: 8px;
      background: #ff6b6b;
      border: 2px solid #000;
      top: -4px;
      left: 50%;
      transform: translateX(-50%);
      border-radius: 50% 50% 0 0;
      transition: all 0.3s ease;
    }

    /* Helm berkilau saat menang */
    .player-sprite.victory .player-helmet-top {
      animation: helmetShine 0.8s ease-in-out infinite;
    }

    @keyframes helmetShine {
      0%, 100% { 
        background: #ff6b6b;
        box-shadow: 0 0 0 rgba(255, 215, 0, 0);
      }
      50% { 
        background: #ffd700;
        box-shadow: 0 0 15px rgba(255, 215, 0, 0.8);
      }
    }

    /* Kaki kiri */
    .player-leg-left {
      position: absolute;
      width: 10px;
      height: 12px;
      background: #654321;
      border: 2px solid #000;
      bottom: -2px;
      left: 18px;
      transition: all 0.3s ease;
    }

    /* Kaki kanan */
    .player-leg-right {
      position: absolute;
      width: 10px;
      height: 12px;
      background: #654321;
      border: 2px solid #000;
      bottom: -2px;
      right: 18px;
      transition: all 0.3s ease;
    }

    /* Kaki bergerak saat berjalan */
    .player-sprite.walking .player-leg-left {
      animation: legLeftWalk 0.6s infinite;
    }

    .player-sprite.walking .player-leg-right {
      animation: legRightWalk 0.6s infinite;
    }

    @keyframes legLeftWalk {
      0%, 100% { 
        transform: translateY(0px);
      }
      50% { 
        transform: translateY(-4px);
      }
    }

    @keyframes legRightWalk {
      0%, 100% { 
        transform: translateY(-4px);
      }
      50% { 
        transform: translateY(0px);
      }
    }

    /* Kaki saat menang - melompat */
    .player-sprite.victory .player-leg-left,
    .player-sprite.victory .player-leg-right {
      animation: legVictory 0.8s ease-in-out infinite;
    }

    @keyframes legVictory {
      0%, 100% { 
        transform: translateY(0px);
      }
      50% { 
        transform: translateY(-6px);
      }
    }

    /* Efek partikel bintang saat menang */
    .victory-particles {
      display: none;
      position: absolute;
      top: -20px;
      left: 50%;
      transform: translateX(-50%);
      width: 100px;
      height: 100px;
      pointer-events: none;
    }

    .player-sprite.victory .victory-particles {
      display: block;
    }

    .victory-particle {
      position: absolute;
      font-size: 16px;
      animation: particleFloat 1.5s ease-out infinite;
      opacity: 0;
    }

    .victory-particle:nth-child(1) { 
      left: 10%; 
      animation-delay: 0s;
    }
    .victory-particle:nth-child(2) { 
      left: 30%; 
      animation-delay: 0.3s;
    }
    .victory-particle:nth-child(3) { 
      left: 50%; 
      animation-delay: 0.6s;
    }
    .victory-particle:nth-child(4) { 
      left: 70%; 
      animation-delay: 0.9s;
    }
    .victory-particle:nth-child(5) { 
      left: 90%; 
      animation-delay: 1.2s;
    }

    @keyframes particleFloat {
      0% {
        opacity: 0;
        transform: translateY(0) scale(0.5);
      }
      20% {
        opacity: 1;
      }
      100% {
        opacity: 0;
        transform: translateY(-60px) scale(1.2);
      }
    }

    .question-box {
      background: #1a1a2e;
      border: 6px solid #ffd700;
      padding: 25px;
      margin: 20px 0;
      font-size: 18px;
      line-height: 1.6;
      position: relative;
      box-shadow: 
        inset 0 0 0 3px #000,
        inset 0 0 0 6px #ffd700,
        4px 4px 0 #000;
    }

    .question-box::before {
      content: '‚ùì';
      position: absolute;
      top: -20px;
      left: 20px;
      font-size: 32px;
      background: #ffd700;
      border: 4px solid #000;
      width: 40px;
      height: 40px;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 4px;
      box-shadow: 2px 2px 0 #000;
    }

    .question-box::after {
      content: '';
      position: absolute;
      bottom: -8px;
      left: 30px;
      width: 0;
      height: 0;
      border-left: 12px solid transparent;
      border-right: 12px solid transparent;
      border-top: 12px solid #ffd700;
      filter: drop-shadow(2px 2px 0 #000);
    }

    .answer-btn {
      background: #4ecdc4;
      color: #000;
      border: 4px solid #000;
      padding: 15px 20px 15px 50px;
      font-size: 16px;
      font-family: 'Courier New', monospace;
      cursor: pointer;
      margin: 8px;
      box-shadow: 4px 4px 0px #000;
      transition: all 0.1s;
      display: block;
      width: 100%;
      max-width: 450px;
      margin: 10px auto;
      text-align: left;
      position: relative;
      font-weight: bold;
    }

    .answer-btn::before {
      content: attr(data-letter);
      position: absolute;
      left: 15px;
      top: 50%;
      transform: translateY(-50%);
      width: 28px;
      height: 28px;
      background: #000;
      color: #4ecdc4;
      border: 3px solid #4ecdc4;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 14px;
      font-weight: bold;
      border-radius: 4px;
    }

    .answer-btn:hover {
      background: #45b8b0;
      transform: translate(2px, 2px);
      box-shadow: 2px 2px 0px #000;
    }

    .answer-btn:hover::before {
      background: #1a1a2e;
      color: #45b8b0;
      border-color: #45b8b0;
    }

    .answer-btn.correct {
      background: #51cf66;
      animation: correctPulse 0.5s;
    }

    .answer-btn.wrong {
      background: #ff6b6b;
      animation: wrongShake 0.5s;
    }

    @keyframes correctPulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.05); }
    }

    @keyframes wrongShake {
      0%, 100% { transform: translateX(0); }
      25% { transform: translateX(-10px); }
      75% { transform: translateX(10px); }
    }

    .treasure-chest {
      width: 140px;
      height: 100px;
      background: #8b4513;
      border: 6px solid #000;
      margin: 30px auto;
      position: relative;
      box-shadow: 6px 6px 0px #000;
      image-rendering: pixelated;
    }

    /* Tutup peti */
    .chest-lid {
      position: absolute;
      width: 100%;
      height: 50%;
      background: #a0522d;
      border: 4px solid #000;
      top: 0;
      left: 0;
      transform-origin: bottom;
      transition: transform 0.8s ease-out;
      box-shadow: inset 0 -4px 0 rgba(0,0,0,0.3);
    }

    .treasure-chest.open .chest-lid {
      transform: rotateX(-120deg) translateY(-20px);
    }

    /* Garis-garis kayu pada tutup */
    .chest-lid::before {
      content: '';
      position: absolute;
      width: 100%;
      height: 100%;
      background: repeating-linear-gradient(
        90deg,
        transparent 0px,
        transparent 18px,
        rgba(0,0,0,0.2) 18px,
        rgba(0,0,0,0.2) 20px
      );
    }

    /* Badan peti */
    .treasure-chest::before {
      content: '';
      position: absolute;
      width: 100%;
      height: 60%;
      background: #8b4513;
      border: 4px solid #000;
      bottom: 0;
      left: 0;
      box-shadow: inset 0 4px 0 rgba(139, 69, 19, 0.5);
    }

    /* Kunci emas */
    .treasure-chest::after {
      content: '';
      position: absolute;
      width: 30px;
      height: 24px;
      background: #ffd700;
      border: 4px solid #000;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      border-radius: 4px;
      box-shadow: inset 0 -4px 0 rgba(0,0,0,0.3);
      z-index: 2;
    }

    /* Lubang kunci */
    .chest-keyhole {
      position: absolute;
      width: 8px;
      height: 12px;
      background: #000;
      top: 52%;
      left: 50%;
      transform: translate(-50%, -50%);
      border-radius: 50% 50% 0 0;
      z-index: 3;
    }

    .chest-keyhole::after {
      content: '';
      position: absolute;
      width: 4px;
      height: 8px;
      background: #000;
      bottom: -8px;
      left: 50%;
      transform: translateX(-50%);
    }

    .treasure-chest.open {
      animation: chestShake 0.8s ease-out;
    }

    @keyframes chestShake {
      0%, 100% { transform: translateX(0) translateY(0); }
      10% { transform: translateX(-4px) translateY(-2px); }
      20% { transform: translateX(4px) translateY(-2px); }
      30% { transform: translateX(-4px) translateY(-2px); }
      40% { transform: translateX(4px) translateY(-2px); }
      50% { transform: translateX(0) translateY(0); }
    }

    .coins {
      display: none;
      position: absolute;
      top: -80px;
      left: 50%;
      transform: translateX(-50%);
      width: 200px;
      text-align: center;
    }

    .treasure-chest.open .coins {
      display: block;
    }

    .coin {
      display: inline-block;
      width: 32px;
      height: 32px;
      background: radial-gradient(circle at 30% 30%, #fff59d, #ffd700 40%, #f9a825);
      border: 4px solid #000;
      border-radius: 50%;
      margin: 0 6px;
      position: relative;
      box-shadow: 
        inset -3px -3px 0 rgba(0,0,0,0.3),
        inset 3px 3px 0 rgba(255,255,255,0.3),
        0 0 20px rgba(255, 215, 0, 0.6);
      animation: coinFloat 1.2s ease-out forwards;
      opacity: 0;
    }

    .coin::before {
      content: '‚òÖ';
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      font-size: 16px;
      color: #f9a825;
      text-shadow: 1px 1px 0 #000;
    }

    .coin:nth-child(1) {
      animation-delay: 0.3s;
    }

    .coin:nth-child(2) {
      animation-delay: 0.4s;
    }

    .coin:nth-child(3) {
      animation-delay: 0.5s;
    }

    .coin:nth-child(4) {
      animation-delay: 0.6s;
    }

    .coin:nth-child(5) {
      animation-delay: 0.7s;
    }

    @keyframes coinFloat {
      0% { 
        opacity: 0;
        transform: translateY(100px) scale(0.5) rotateY(0deg);
      }
      50% {
        opacity: 1;
        transform: translateY(-20px) scale(1.1) rotateY(180deg);
      }
      100% { 
        opacity: 1;
        transform: translateY(0) scale(1) rotateY(360deg);
      }
    }

    /* Efek berkilau pada koin */
    .coin::after {
      content: '';
      position: absolute;
      top: 2px;
      left: 2px;
      width: 8px;
      height: 8px;
      background: rgba(255, 255, 255, 0.8);
      border-radius: 50%;
      animation: sparkle 1.5s infinite;
    }

    @keyframes sparkle {
      0%, 100% { 
        opacity: 0;
        transform: scale(0.5);
      }
      50% { 
        opacity: 1;
        transform: scale(1);
      }
    }

    /* Partikel cahaya */
    .light-particles {
      display: none;
      position: absolute;
      top: -60px;
      left: 50%;
      transform: translateX(-50%);
      width: 200px;
      height: 200px;
      pointer-events: none;
    }

    .treasure-chest.open .light-particles {
      display: block;
    }

    .particle {
      position: absolute;
      width: 6px;
      height: 6px;
      background: #ffd700;
      border-radius: 50%;
      animation: particleRise 2s ease-out forwards;
      opacity: 0;
      box-shadow: 0 0 10px #ffd700;
    }

    .particle:nth-child(1) { left: 20%; animation-delay: 0.5s; }
    .particle:nth-child(2) { left: 40%; animation-delay: 0.6s; }
    .particle:nth-child(3) { left: 60%; animation-delay: 0.7s; }
    .particle:nth-child(4) { left: 80%; animation-delay: 0.8s; }
    .particle:nth-child(5) { left: 30%; animation-delay: 0.9s; }
    .particle:nth-child(6) { left: 70%; animation-delay: 1s; }

    @keyframes particleRise {
      0% {
        opacity: 0;
        transform: translateY(0) scale(0);
      }
      20% {
        opacity: 1;
      }
      100% {
        opacity: 0;
        transform: translateY(-150px) scale(1.5);
      }
    }

    .score-display {
      font-size: 36px;
      color: #ffd700;
      margin: 20px 0;
      text-shadow: 3px 3px 0px #000;
    }

    .stage-indicator {
      font-size: 24px;
      color: #4ecdc4;
      margin-bottom: 20px;
      text-shadow: 2px 2px 0px #000;
    }

    .hearts {
      font-size: 32px;
      margin: 15px 0;
    }

    .feedback-message {
      font-size: 20px;
      margin: 15px 0;
      padding: 20px 25px;
      border: 5px solid #000;
      background: #2d2d44;
      display: none;
      font-weight: bold;
      text-align: center;
      box-shadow: 4px 4px 0 #000;
      position: relative;
      max-width: 450px;
      margin: 15px auto;
    }

    .feedback-message.show {
      display: block;
      animation: feedbackPop 0.3s ease-out;
    }

    @keyframes feedbackPop {
      0% { 
        transform: scale(0.8);
        opacity: 0;
      }
      50% { 
        transform: scale(1.05);
      }
      100% { 
        transform: scale(1);
        opacity: 1;
      }
    }

    .feedback-message.correct {
      color: #51cf66;
      border-color: #51cf66;
      background: #1a2e1a;
      box-shadow: 
        0 0 20px rgba(81, 207, 102, 0.3),
        4px 4px 0 #000;
    }

    .feedback-message.wrong {
      color: #ff6b6b;
      border-color: #ff6b6b;
      background: #2e1a1a;
      box-shadow: 
        0 0 20px rgba(255, 107, 107, 0.3),
        4px 4px 0 #000;
    }

    /* Victory Screen Styles */
    .victory-banner {
      position: relative;
      margin-bottom: 30px;
      padding: 20px 0;
    }

    .banner-flag {
      position: absolute;
      top: 0;
      width: 80px;
      height: 100px;
      background: #ff6b6b;
      border: 4px solid #000;
      box-shadow: 4px 4px 0 #000;
    }

    .banner-flag::after {
      content: '';
      position: absolute;
      bottom: -20px;
      left: 0;
      width: 0;
      height: 0;
      border-left: 40px solid #ff6b6b;
      border-right: 40px solid #ff6b6b;
      border-bottom: 20px solid transparent;
      filter: drop-shadow(2px 2px 0 #000);
    }

    .banner-flag-left {
      left: 10%;
      animation: flagWave 2s ease-in-out infinite;
    }

    .banner-flag-right {
      right: 10%;
      animation: flagWave 2s ease-in-out infinite 1s;
    }

    @keyframes flagWave {
      0%, 100% { transform: rotate(-2deg); }
      50% { transform: rotate(2deg); }
    }

    .victory-title {
      position: relative;
      z-index: 1;
      animation: titleBounce 1s ease-in-out infinite;
    }

    @keyframes titleBounce {
      0%, 100% { transform: translateY(0px); }
      50% { transform: translateY(-10px); }
    }

    .score-card {
      background: #2d2d44;
      border: 6px solid #000;
      box-shadow: 8px 8px 0 #000;
      padding: 30px;
      margin: 20px auto;
      max-width: 500px;
      position: relative;
      overflow: hidden;
    }

    .score-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 8px;
      background: repeating-linear-gradient(
        90deg,
        #ffd700 0px,
        #ffd700 20px,
        #ff6b6b 20px,
        #ff6b6b 40px,
        #4ecdc4 40px,
        #4ecdc4 60px
      );
    }

    .score-card-header {
      text-align: center;
      margin-bottom: 25px;
    }

    .trophy-icon {
      font-size: 64px;
      animation: trophyFloat 2s ease-in-out infinite;
      filter: drop-shadow(4px 4px 0 #000);
    }

    @keyframes trophyFloat {
      0%, 100% { transform: translateY(0px) scale(1); }
      50% { transform: translateY(-15px) scale(1.1); }
    }

    .stars-decoration {
      margin-top: 10px;
    }

    .star {
      display: inline-block;
      font-size: 32px;
      margin: 0 8px;
      animation: starTwinkle 1.5s ease-in-out infinite;
      filter: drop-shadow(2px 2px 0 #000);
    }

    .star:nth-child(1) { animation-delay: 0s; }
    .star:nth-child(2) { animation-delay: 0.3s; }
    .star:nth-child(3) { animation-delay: 0.6s; }

    @keyframes starTwinkle {
      0%, 100% { 
        transform: scale(1) rotate(0deg);
        opacity: 1;
      }
      50% { 
        transform: scale(1.3) rotate(180deg);
        opacity: 0.8;
      }
    }

    .score-card-body {
      text-align: center;
      margin-bottom: 25px;
    }

    .score-label {
      font-size: 20px;
      color: #4ecdc4;
      font-weight: bold;
      margin-bottom: 10px;
      text-shadow: 2px 2px 0 #000;
      letter-spacing: 3px;
    }

    .score-value {
      font-size: 72px;
      color: #ffd700;
      font-weight: bold;
      text-shadow: 
        4px 4px 0 #000,
        0 0 20px rgba(255, 215, 0, 0.5);
      margin-bottom: 25px;
      animation: scoreGlow 2s ease-in-out infinite;
    }

    @keyframes scoreGlow {
      0%, 100% { 
        text-shadow: 
          4px 4px 0 #000,
          0 0 20px rgba(255, 215, 0, 0.5);
      }
      50% { 
        text-shadow: 
          4px 4px 0 #000,
          0 0 30px rgba(255, 215, 0, 0.8),
          0 0 40px rgba(255, 215, 0, 0.6);
      }
    }

    .stats-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 15px;
      margin-top: 20px;
    }

    .stat-item {
      background: #1a1a2e;
      border: 4px solid #000;
      padding: 15px 10px;
      box-shadow: 3px 3px 0 #000;
      transition: transform 0.2s;
    }

    .stat-item:hover {
      transform: translateY(-5px);
      box-shadow: 3px 8px 0 #000;
    }

    .stat-icon {
      font-size: 28px;
      margin-bottom: 8px;
    }

    .stat-label {
      font-size: 12px;
      color: #aaa;
      margin-bottom: 5px;
      text-transform: uppercase;
      letter-spacing: 1px;
    }

    .stat-value {
      font-size: 24px;
      color: #fff;
      font-weight: bold;
      text-shadow: 2px 2px 0 #000;
    }

    .achievement-message {
      background: #ffd700;
      color: #000;
      border: 4px solid #000;
      padding: 15px;
      margin-top: 25px;
      font-size: 20px;
      font-weight: bold;
      text-align: center;
      box-shadow: 4px 4px 0 #000;
      animation: achievementPulse 1.5s ease-in-out infinite;
    }

    @keyframes achievementPulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.05); }
    }

    .victory-buttons {
      display: flex;
      gap: 15px;
      justify-content: center;
      flex-wrap: wrap;
      margin-top: 25px;
    }

    .btn-primary {
      background: #ff6b6b;
      flex: 1;
      min-width: 200px;
      max-width: 250px;
    }

    .btn-primary:hover {
      background: #ff5252;
    }

    .btn-secondary {
      background: #4ecdc4;
      color: #000;
      flex: 1;
      min-width: 200px;
      max-width: 250px;
    }

    .btn-secondary:hover {
      background: #45b8b0;
    }

    .share-notification {
      display: none;
      background: #51cf66;
      color: #000;
      border: 4px solid #000;
      padding: 15px 25px;
      margin: 20px auto 0;
      max-width: 400px;
      font-weight: bold;
      box-shadow: 4px 4px 0 #000;
      animation: notificationSlide 0.3s ease-out;
    }

    .share-notification.show {
      display: block;
    }

    @keyframes notificationSlide {
      0% {
        opacity: 0;
        transform: translateY(-20px);
      }
      100% {
        opacity: 1;
        transform: translateY(0);
      }
    }

    /* Game Over Screen Styles */
    .gameover-banner {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 20px;
      margin-bottom: 30px;
    }

    .skull-decoration {
      font-size: 48px;
      animation: skullShake 1s ease-in-out infinite;
      filter: drop-shadow(3px 3px 0 #000);
    }

    @keyframes skullShake {
      0%, 100% { transform: rotate(-5deg); }
      50% { transform: rotate(5deg); }
    }

    .gameover-title {
      color: #ff6b6b;
      margin: 0;
    }

    .gameover-card {
      border-color: #ff6b6b;
    }

    .gameover-card::before {
      background: repeating-linear-gradient(
        90deg,
        #ff6b6b 0px,
        #ff6b6b 20px,
        #000 20px,
        #000 40px
      );
    }

    .gameover-message {
      text-align: center;
      margin-bottom: 25px;
      padding: 20px;
      background: #2e1a1a;
      border: 4px solid #ff6b6b;
      box-shadow: inset 0 0 20px rgba(255, 107, 107, 0.2);
    }

    .broken-heart {
      font-size: 56px;
      animation: heartBreak 2s ease-in-out infinite;
      filter: drop-shadow(3px 3px 0 #000);
    }

    @keyframes heartBreak {
      0%, 100% { transform: scale(1); }
      25% { transform: scale(1.1) rotate(-5deg); }
      75% { transform: scale(0.9) rotate(5deg); }
    }

    .gameover-text {
      font-size: 22px;
      color: #ff6b6b;
      font-weight: bold;
      margin: 15px 0 5px;
      text-shadow: 2px 2px 0 #000;
    }

    .gameover-subtext {
      font-size: 16px;
      color: #aaa;
      margin: 0;
    }

    .motivational-quote {
      background: #1a1a2e;
      border: 4px solid #4ecdc4;
      border-left: 8px solid #4ecdc4;
      padding: 15px 20px;
      margin-top: 25px;
      font-size: 16px;
      font-style: italic;
      color: #4ecdc4;
      text-align: center;
      box-shadow: 3px 3px 0 #000;
    }

    .motivational-quote::before {
      content: '"';
      font-size: 32px;
      color: #4ecdc4;
      opacity: 0.5;
    }

    .motivational-quote::after {
      content: '"';
      font-size: 32px;
      color: #4ecdc4;
      opacity: 0.5;
    }

    @media (max-width: 600px) {
      .stats-grid {
        grid-template-columns: 1fr;
        gap: 10px;
      }

      .victory-buttons {
        flex-direction: column;
      }

      .btn-primary,
      .btn-secondary {
        min-width: 100%;
        max-width: 100%;
      }

      .banner-flag {
        width: 60px;
        height: 80px;
      }

      .banner-flag::after {
        border-left: 30px solid #ff6b6b;
        border-right: 30px solid #ff6b6b;
      }
    }
  </style>
  <style>@view-transition { navigation: auto; }</style>
  <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
  <script src="https://cdn.tailwindcss.com" type="text/javascript"></script>
 </head>
 <body>
  <div class="game-container">
   <div id="startScreen" class="screen active">
    <h1 class="title" id="gameTitle">‚öîÔ∏è DUNGEON SEJARAH ‚öîÔ∏è</h1>
    <p class="subtitle" id="welcomeMessage">Selamat datang di Dungeon Sejarah! Jawab pertanyaan untuk menemukan harta karun!</p><button class="btn" id="startBtn">üéÆ MULAI PETUALANGAN</button>
   </div>
   <div id="gameScreen" class="screen">
    <div class="stage-indicator" id="stageIndicator">
     STAGE 1 / 3
    </div>
    <div class="hearts" id="hearts">
     ‚ù§Ô∏è ‚ù§Ô∏è ‚ù§Ô∏è
    </div>
    <div class="dungeon-stage">
     <div class="stone-wall"></div>
     <div class="stone-block"></div>
     <div class="stone-block"></div>
     <div class="stone-block"></div>
     <div class="stone-block"></div>
     <div class="stone-block"></div>
     <div class="stone-block"></div>
     <div class="torch-left"></div>
     <div class="torch-right"></div>
     <div class="dungeon-gate">
      <div class="gate-arrow"></div>
     </div><!-- Progress Path -->
     <div class="progress-path" id="progressPath">
      <div class="path-line"></div><!-- Stage nodes akan ditambahkan via JavaScript -->
     </div><!-- Jalan setapak menuju trigger -->
     <div class="stone-path">
      <div class="path-stone"></div>
      <div class="path-stone"></div>
      <div class="path-stone"></div>
      <div class="path-stone"></div>
     </div><!-- Trigger Area -->
     <div class="trigger-area">
      <div class="trigger-circle-outer"></div>
      <div class="trigger-circle-middle"></div>
      <div class="trigger-platform"></div>
      <div class="trigger-sparkles">
       <div class="trigger-sparkle"></div>
       <div class="trigger-sparkle"></div>
       <div class="trigger-sparkle"></div>
       <div class="trigger-sparkle"></div>
       <div class="trigger-sparkle"></div>
       <div class="trigger-sparkle"></div>
      </div>
     </div>
     <div class="stage-content">
      <div class="player-sprite idle" id="playerSprite">
       <div class="player-helmet-top"></div>
       <div class="player-eye-left"></div>
       <div class="player-eye-right"></div>
       <div class="player-sword"></div>
       <div class="player-leg-left"></div>
       <div class="player-leg-right"></div>
       <div class="victory-particles">
        <div class="victory-particle">
         ‚≠ê
        </div>
        <div class="victory-particle">
         ‚ú®
        </div>
        <div class="victory-particle">
         ‚≠ê
        </div>
        <div class="victory-particle">
         ‚ú®
        </div>
        <div class="victory-particle">
         ‚≠ê
        </div>
       </div>
      </div>
      <div class="question-box" id="questionBox">
       Memuat pertanyaan...
      </div>
      <div id="answersContainer"></div>
     </div>
    </div>
    <div class="feedback-message" id="feedbackMessage"></div>
   </div>
   <div id="victoryScreen" class="screen">
    <div class="victory-banner">
     <div class="banner-flag banner-flag-left"></div>
     <div class="banner-flag banner-flag-right"></div>
     <h1 class="title victory-title">üèÜ KEMENANGAN! üèÜ</h1>
    </div>
    <div class="score-card">
     <div class="score-card-header">
      <div class="trophy-icon">
       üèÜ
      </div>
      <div class="stars-decoration"><span class="star">‚≠ê</span> <span class="star">‚≠ê</span> <span class="star">‚≠ê</span>
      </div>
     </div>
     <div class="score-card-body">
      <div class="score-label">
       SKOR AKHIR
      </div>
      <div class="score-value" id="finalScore">
       0
      </div>
      <div class="stats-grid">
       <div class="stat-item">
        <div class="stat-icon">
         ‚úÖ
        </div>
        <div class="stat-label">
         Benar
        </div>
        <div class="stat-value" id="correctAnswers">
         0
        </div>
       </div>
       <div class="stat-item">
        <div class="stat-icon">
         ‚ùå
        </div>
        <div class="stat-label">
         Salah
        </div>
        <div class="stat-value" id="wrongAnswers">
         0
        </div>
       </div>
       <div class="stat-item">
        <div class="stat-icon">
         ‚ù§Ô∏è
        </div>
        <div class="stat-label">
         Nyawa
        </div>
        <div class="stat-value" id="remainingLives">
         0
        </div>
       </div>
      </div>
     </div>
     <div class="treasure-chest" id="treasureChest">
      <div class="chest-lid"></div>
      <div class="chest-keyhole"></div>
      <div class="light-particles">
       <div class="particle"></div>
       <div class="particle"></div>
       <div class="particle"></div>
       <div class="particle"></div>
       <div class="particle"></div>
       <div class="particle"></div>
      </div>
      <div class="coins"><span class="coin"></span> <span class="coin"></span> <span class="coin"></span> <span class="coin"></span> <span class="coin"></span>
      </div>
     </div>
     <div class="achievement-message" id="achievementMessage">
      PETUALANG SEJATI!
     </div>
    </div>
    <div class="victory-buttons"><button class="btn btn-primary" id="playAgainBtn">üîÑ MAIN LAGI</button> <button class="btn btn-secondary" id="shareScoreBtn">üì§ BAGIKAN SKOR</button> <button class="btn btn-secondary" id="backToMenuBtn">üè† MENU UTAMA</button>
    </div>
    <div class="share-notification" id="shareNotification">
     ‚úÖ Skor berhasil disalin ke clipboard!
    </div>
   </div>
   <div id="gameOverScreen" class="screen">
    <div class="gameover-banner">
     <div class="skull-decoration">
      üíÄ
     </div>
     <h1 class="title gameover-title">GAME OVER</h1>
     <div class="skull-decoration">
      üíÄ
     </div>
    </div>
    <div class="score-card gameover-card">
     <div class="gameover-message">
      <div class="broken-heart">
       üíî
      </div>
      <p class="gameover-text">Kamu kehabisan nyawa!</p>
      <p class="gameover-subtext">Jangan menyerah, coba lagi!</p>
     </div>
     <div class="score-card-body">
      <div class="score-label">
       SKOR AKHIR
      </div>
      <div class="score-value" id="gameOverScore">
       0
      </div>
      <div class="stats-grid">
       <div class="stat-item">
        <div class="stat-icon">
         ‚úÖ
        </div>
        <div class="stat-label">
         Benar
        </div>
        <div class="stat-value" id="correctAnswersGameOver">
         0
        </div>
       </div>
       <div class="stat-item">
        <div class="stat-icon">
         ‚ùå
        </div>
        <div class="stat-label">
         Salah
        </div>
        <div class="stat-value" id="wrongAnswersGameOver">
         0
        </div>
       </div>
       <div class="stat-item">
        <div class="stat-icon">
         üìä
        </div>
        <div class="stat-label">
         Progress
        </div>
        <div class="stat-value" id="progressGameOver">
         0/15
        </div>
       </div>
      </div>
     </div>
     <div class="motivational-quote">
      "Kegagalan adalah kesuksesan yang tertunda"
     </div>
    </div>
    <div class="victory-buttons"><button class="btn btn-primary" id="retryBtn">üîÑ COBA LAGI</button> <button class="btn btn-secondary" id="shareScoreGameOverBtn">üì§ BAGIKAN SKOR</button> <button class="btn btn-secondary" id="backToMenuGameOverBtn">üè† MENU UTAMA</button>
    </div>
    <div class="share-notification" id="shareNotificationGameOver">
     ‚úÖ Skor berhasil disalin ke clipboard!
    </div>
   </div>
  </div>
  <script>
    const defaultConfig = {
      game_title: "‚öîÔ∏è DUNGEON SEJARAH ‚öîÔ∏è",
      welcome_message: "Selamat datang di Dungeon Sejarah! Jawab pertanyaan untuk menemukan harta karun!",
      start_button_text: "üéÆ MULAI PETUALANGAN",
      background_color: "#1a1a2e",
      primary_color: "#ff6b6b",
      secondary_color: "#4ecdc4",
      accent_color: "#ffd700",
      text_color: "#eee",
      font_family: "Courier New",
      font_size: 16
    };

    const questions = [
      {
        stage: 1,
        question: "Kerajaan Islam Banten didirikan oleh tokoh yang bernama ....",
        answers: [
          { text: "Sunan Gunung Jati", correct: false },
          { text: "Maulana Hassanuddin", correct: true },
          { text: "Fatahillah", correct: false },
          { text: "Sultan Ageng Tirtayasa", correct: false }
        ]
      },
      {
        stage: 2,
        question: "Kerajaan Banten terletak di wilayah yang sekarang termasuk provinsi ...",
        answers: [
          { text: "Jawa Barat", correct: false },
          { text: "Jawa Tengah", correct: false },
          { text: "Banten", correct: true },
          { text: "DKI Jakarta", correct: false }
        ]
      },
      {
        stage: 3,
        question: "Maulana Hasanuddin merupakan putra dari ...",
        answers: [
          { text: "Sunan Kalijaga", correct: false },
          { text: "Sunan Gunung Jati", correct: true },
          { text: "Sultan Ageng Tritayasa", correct: false },
          { text: "Sultan Maulana Yusuf", correct: false }
        ]
      },
      {
        stage: 4,
        question: "Sebelum menjadi kerajaan Islam, daerah Banten berada di bawah kekuasaan kerajaan ....",
        answers: [
          { text: "Tarumanegara", correct: false },
          { text: "Pajajaran", correct: true },
          { text: "Demak", correct: false },
          { text: "Mataram", correct: false }
        ]
      },
      {
        stage: 5,
        question: "Kerajaan Banten mencapai puncak kejayaan pada masa pemerintahan ...",
        answers: [
          { text: "Maulana Hassanuddin", correct: false },
          { text: "Sultan Ageng Tritayasa", correct: true },
          { text: "Sunan Gunung Jati", correct: false },
          { text: "Sultan Maulana yusuf", correct: false }
        ]
      },
      {
        stage: 6,
        question: "Pelabuhan Banten terkenal sebagai pusat perdagangan internasional yang ramai karena ....",
        answers: [
          { text: "Letaknya Strategis Di Jalur Pelayaran Dunia", correct: true },
          { text: "Mengandalkan Pertanian Padi", correct: false },
          { text: "Menjual Hasil Hutan", correct: false },
          { text: "memiliki Tambang Emas", correct: false }
        ]
      },
      {
        stage: 7,
        question: "Keruntuhan Kerajaan Banten disebabkan oleh ....",
        answers: [
          { text: "Serangan Portugis", correct: false },
          { text: "Pertikaian Internal Keluarga Kerajaan", correct: true },
          { text: "Serangan Dari Mataram", correct: false },
          { text: "Wabah Penyakit", correct: false }
        ]
      },
      {
        stage: 8,
        question: "Tokoh yang terkenal melawan campur tangan VOC Belanda dalam pemerintahan Banten adalah ....",
        answers: [
          { text: "Maulana Yusuf", correct: false },
          { text: "Sultan Ageng Tritayasa", correct: true },
          { text: "Pangeran Diponegoro", correct: false },
          { text: "Sultan Haji", correct: false }
        ]
      },
      {
        stage: 9,
        question: "Sultan Ageng Tirtayasa melawan VOC karena ...",
        answers: [
          { text: "VOC Menguasai Pelabuhan Banten", correct: false },
          { text: "VOC Membantu Putranya Merebut Kekuasaan", correct: true },
          { text: "VOC Menolak Berdagang Dengan Banten", correct: false },
          { text: "VOC Menolak Agama Islam", correct: false }
        ]
      },
      {
        stage: 10,
        question: "Setelah Sultan Ageng Tirtayasa dikalahkan, Banten menjadi ....",
        answers: [
          { text: "WIlayah Kerajaan Mataram", correct: false },
          { text: "Daerah Jajahan Belanda (VOC)", correct: true },
          { text: "Sekutu VOC", correct: false },
          { text: "Wilayah Kesultanan Cirebon", correct: false }
        ]
      },
      {
        stage: 11,
        question: "Benteng peninggalan Kerajaan Banten yang masih terkenal sampai sekarang adalah ....",
        answers: [
          { text: "Benteng Speelwijk", correct: true },
          { text: "Benteng Rotterdam", correct: false },
          { text: "Benteng Vredeburg", correct: false },
          { text: "Benteng Marlborough", correct: false }
        ]
      },
      {
        stage: 12,
        question: "Salah satu hasil perdagangan utama dari Kerajaan Banten adalah ....",
        answers: [
          { text: "Pala dan Lada", correct: true },
          { text: "Kopi dan Teh", correct: false },
          { text: "Emas dan Perak", correct: false },
          { text: "Sutra dan Kain", correct: false }
        ]
      },
      {
        stage: 13,
        question: "Islam masuk ke Banten dibawa oleh ...",
        answers: [
          { text: "Belanda", correct: false },
          { text: "Portugis", correct: false },
          { text: "Para Pedagang Dari Gujarat", correct: true },
          { text: "Jepang", correct: false }
        ]
      },
      {
        stage: 14,
        question: "Sultan Maulana Yusuf terkenal karena ....",
        answers: [
          { text: "Membuka Perdagangan Dengan Eropa", correct: false },
          { text: "Menjalin Hubungan Dengan Demak", correct: false },
          { text: "Menghapus Sistem Kerajaan", correct: false },
          { text: "Melanjutkan Dakwah Islam Ke Pedalaman Sunda", correct: true }
        ]
      },
      {
        stage: 15,
        question: "Pusat pemerintahan Kerajaan Banten disebut ....",
        answers: [
          { text: "Surosowan", correct: true },
          { text: "Banten Girang", correct: false },
          { text: "kartasura", correct: false },
          { text: "Jayakarta", correct: false }
        ]
      },
      {
        stage: 16,
        question: "Salah satu penyebab kemunduran ekonomi Banten adalah .....",
        answers: [
          { text: "Hasil Pertanian Menurun", correct: false },
          { text: "Kekurangan Tenaga Kerja", correct: false },
          { text: "VOC Memblokade Pelabuhan Banten", correct: true },
          { text: "Serangan Portugis", correct: false }
        ]
      },
      {
        stage: 17,
        question: "Raja pertama Kerajaan Banten bergelar ....",
        answers: [
          { text: "Sultan Maulana Hassanuddin", correct: true },
          { text: "Sultan Ageng Tritayasa", correct: false },
          { text: "Sultan Maulana Yusuf", correct: false },
          { text: "Sunan Gunung Jati", correct: false }
        ]
      },
      {
        stage: 18,
        question: "Kerajaan Banten banyak dikunjungi pedagang asing dari ....",
        answers: [
          { text: "Arab,Cina,dan Eropa", correct: true },
          { text: "Amerika,Afrika,dan Eropa", correct: false },
          { text: "Jepang,India,dan Australia", correct: false },
          { text: "Eropa dan Rusia", correct: false }
        ]
      },
      {
        stage: 19,
        question: "Pada masa kejayaannya, Banten terkenal sebagai penghasil ....",
        answers: [
          { text: "Kapas", correct: false },
          { text: "Lada", correct: true },
          { text: "Emas", correct: false },
          { text: "Minyak", correct: false }
        ]
      },
      {
        stage: 20,
        question: "Sultan Haji bersekutu dengan VOC karena ....",
        answers: [
          { text: "Ingin Memperluas Wilayah Kekuasaan", correct: false },
          { text: "Ingin Menaklikkan Kekuasaan", correct: false },
          { text: "Ingin Merebut Kekuasaan dari Ayahnya, Sultan Ageng Tritayasa", correct: true },
          { text: "Ingin Memperkuat Ekonomi Banten", correct: false }
        ]
      },
    ];

    let currentStage = 0;
    let score = 0;
    let lives = 3;
    let correctCount = 0;
    let wrongCount = 0;

    function showScreen(screenId) {
      document.querySelectorAll('.screen').forEach(screen => {
        screen.classList.remove('active');
      });
      document.getElementById(screenId).classList.add('active');
    }

    function initProgressPath() {
      const progressPath = document.getElementById('progressPath');
      if (!progressPath) return;

      // Bersihkan node yang ada (kecuali path-line)
      const existingNodes = progressPath.querySelectorAll('.stage-node');
      existingNodes.forEach(node => node.remove());

      // Tentukan berapa banyak node yang ditampilkan (maksimal 5 untuk tampilan yang baik)
      const totalStages = questions.length;
      const displayNodes = Math.min(5, totalStages);
      
      // Hitung stage mana yang akan ditampilkan
      let startStage = Math.max(0, currentStage - 2);
      let endStage = Math.min(totalStages, startStage + displayNodes);
      
      // Adjust jika mendekati akhir
      if (endStage === totalStages) {
        startStage = Math.max(0, totalStages - displayNodes);
      }

      // Buat node untuk setiap stage yang ditampilkan
      for (let i = startStage; i < endStage; i++) {
        const node = document.createElement('div');
        node.className = 'stage-node';
        
        // Tentukan status node
        if (i < currentStage) {
          node.classList.add('unlocked');
        } else if (i === currentStage) {
          node.classList.add('current');
        }
        
        // Buat struktur node
        node.innerHTML = `
          <div class="stage-door">
            <div class="stage-lock"></div>
          </div>
          <div class="stage-number">${i + 1}</div>
        `;
        
        progressPath.appendChild(node);
      }
    }

    function updateProgressPath() {
      initProgressPath();
    }

    function updateHearts() {
      const heartsContainer = document.getElementById('hearts');
      heartsContainer.textContent = '‚ù§Ô∏è '.repeat(lives);
    }

    function loadQuestion() {
      if (currentStage >= questions.length) {
        showVictory();
        return;
      }

      // Update progress path
      updateProgressPath();

      // Karakter berjalan saat pindah stage
      setPlayerState('walking');
      
      setTimeout(() => {
        // Kembali ke idle setelah berjalan
        setPlayerState('idle');
        
        const question = questions[currentStage];
        document.getElementById('stageIndicator').textContent = `STAGE ${currentStage + 1} / ${questions.length}`;
        document.getElementById('questionBox').textContent = question.question;
        
        const answersContainer = document.getElementById('answersContainer');
        answersContainer.innerHTML = '';
        
        question.answers.forEach((answer, index) => {
          const btn = document.createElement('button');
          btn.className = 'answer-btn';
          btn.textContent = answer.text;
          btn.setAttribute('data-letter', String.fromCharCode(65 + index));
          btn.onclick = () => checkAnswer(answer.correct, btn);
          answersContainer.appendChild(btn);
        });

        document.getElementById('feedbackMessage').classList.remove('show');
      }, 600);
    }

    function setPlayerState(state) {
      const player = document.getElementById('playerSprite');
      if (player) {
        player.className = `player-sprite ${state}`;
      }
    }

    function checkAnswer(isCorrect, btn) {
      const allButtons = document.querySelectorAll('.answer-btn');
      allButtons.forEach(b => b.disabled = true);

      const feedbackMessage = document.getElementById('feedbackMessage');
      const pointsPerQuestion = Math.round((100 / questions.length) * 10) / 10;
      
      if (isCorrect) {
        btn.classList.add('correct');
        score += pointsPerQuestion;
        correctCount++;
        feedbackMessage.textContent = `‚úÖ BENAR! +${pointsPerQuestion.toFixed(1)} Poin`;
        feedbackMessage.className = 'feedback-message show correct';
        
        // Karakter menang
        setPlayerState('victory');
        
        setTimeout(() => {
          currentStage++;
          loadQuestion();
        }, 1500);
      } else {
        btn.classList.add('wrong');
        lives--;
        wrongCount++;
        updateHearts();
        feedbackMessage.textContent = '‚ùå SALAH! -1 Nyawa';
        feedbackMessage.className = 'feedback-message show wrong';
        
        // Karakter kalah
        setPlayerState('defeat');
        
        if (lives <= 0) {
          setTimeout(() => {
            showGameOver();
          }, 1500);
        } else {
          setTimeout(() => {
            currentStage++;
            loadQuestion();
          }, 1500);
        }
      }
    }

    function showVictory() {
      showScreen('victoryScreen');
      document.getElementById('finalScore').textContent = Math.round(score);
      document.getElementById('correctAnswers').textContent = correctCount;
      document.getElementById('wrongAnswers').textContent = wrongCount;
      document.getElementById('remainingLives').textContent = lives;
      
      // Achievement message based on performance
      const achievementMsg = document.getElementById('achievementMessage');
      if (lives === 3) {
        achievementMsg.textContent = 'üåü SEMPURNA! MASTER SEJARAH! üåü';
        achievementMsg.style.background = '#ffd700';
      } else if (lives >= 2) {
        achievementMsg.textContent = '‚≠ê HEBAT! AHLI SEJARAH! ‚≠ê';
        achievementMsg.style.background = '#4ecdc4';
      } else {
        achievementMsg.textContent = '‚ú® BAGUS! PELAJAR SEJARAH! ‚ú®';
        achievementMsg.style.background = '#51cf66';
      }
      
      setTimeout(() => {
        document.getElementById('treasureChest').classList.add('open');
      }, 500);
    }

    function showGameOver() {
      showScreen('gameOverScreen');
      document.getElementById('gameOverScore').textContent = Math.round(score);
      document.getElementById('correctAnswersGameOver').textContent = correctCount;
      document.getElementById('wrongAnswersGameOver').textContent = wrongCount;
      document.getElementById('progressGameOver').textContent = `${currentStage}/${questions.length}`;
    }

    function resetGame() {
      currentStage = 0;
      score = 0;
      lives = 3;
      correctCount = 0;
      wrongCount = 0;
      updateHearts();
      document.getElementById('treasureChest').classList.remove('open');
      setPlayerState('idle');
      initProgressPath();
      showScreen('gameScreen');
      loadQuestion();
    }

    function shareScore(isVictory) {
      const emoji = isVictory ? 'üèÜ' : 'üíÄ';
      const status = isVictory ? 'MENANG' : 'GAME OVER';
      const achievement = isVictory 
        ? (lives === 3 ? 'SEMPURNA!' : lives >= 2 ? 'HEBAT!' : 'BAGUS!')
        : `Progress: ${currentStage}/${questions.length}`;
      
      const shareText = `${emoji} DUNGEON SEJARAH ${emoji}
${status}!

üìä Skor: ${Math.round(score)}
‚úÖ Benar: ${correctCount}
‚ùå Salah: ${wrongCount}
${isVictory ? `‚ù§Ô∏è Nyawa: ${lives}` : ''}

${achievement}

Mainkan sekarang dan uji pengetahuan sejarahmu!`;

      // Copy to clipboard
      if (navigator.clipboard && navigator.clipboard.writeText) {
        navigator.clipboard.writeText(shareText).then(() => {
          const notificationId = isVictory ? 'shareNotification' : 'shareNotificationGameOver';
          const notification = document.getElementById(notificationId);
          notification.classList.add('show');
          
          setTimeout(() => {
            notification.classList.remove('show');
          }, 3000);
        }).catch(() => {
          // Fallback if clipboard API fails
          showShareFallback(shareText, isVictory);
        });
      } else {
        // Fallback for browsers that don't support clipboard API
        showShareFallback(shareText, isVictory);
      }
    }

    function showShareFallback(text, isVictory) {
      const notificationId = isVictory ? 'shareNotification' : 'shareNotificationGameOver';
      const notification = document.getElementById(notificationId);
      notification.textContent = 'üìã Skor siap dibagikan!';
      notification.classList.add('show');
      
      // Create temporary textarea for fallback copy
      const textarea = document.createElement('textarea');
      textarea.value = text;
      textarea.style.position = 'fixed';
      textarea.style.opacity = '0';
      document.body.appendChild(textarea);
      textarea.select();
      
      try {
        document.execCommand('copy');
      } catch (err) {
        notification.textContent = '‚ùå Gagal menyalin skor';
      }
      
      document.body.removeChild(textarea);
      
      setTimeout(() => {
        notification.classList.remove('show');
        notification.textContent = '‚úÖ Skor berhasil disalin ke clipboard!';
      }, 3000);
    }

    function backToMenu() {
      currentStage = 0;
      score = 0;
      lives = 3;
      correctCount = 0;
      wrongCount = 0;
      updateHearts();
      document.getElementById('treasureChest').classList.remove('open');
      showScreen('startScreen');
    }

    document.getElementById('startBtn').onclick = resetGame;
    document.getElementById('playAgainBtn').onclick = resetGame;
    document.getElementById('retryBtn').onclick = resetGame;
    document.getElementById('shareScoreBtn').onclick = () => shareScore(true);
    document.getElementById('shareScoreGameOverBtn').onclick = () => shareScore(false);
    document.getElementById('backToMenuBtn').onclick = backToMenu;
    document.getElementById('backToMenuGameOverBtn').onclick = backToMenu;

    async function onConfigChange(config) {
      const gameTitle = document.getElementById('gameTitle');
      const welcomeMessage = document.getElementById('welcomeMessage');
      const startBtn = document.getElementById('startBtn');

      gameTitle.textContent = config.game_title || defaultConfig.game_title;
      welcomeMessage.textContent = config.welcome_message || defaultConfig.welcome_message;
      startBtn.textContent = config.start_button_text || defaultConfig.start_button_text;

      const backgroundColor = config.background_color || defaultConfig.background_color;
      const primaryColor = config.primary_color || defaultConfig.primary_color;
      const secondaryColor = config.secondary_color || defaultConfig.secondary_color;
      const accentColor = config.accent_color || defaultConfig.accent_color;
      const textColor = config.text_color || defaultConfig.text_color;

      document.body.style.background = backgroundColor;
      document.body.style.color = textColor;
      document.querySelector('.game-container').style.background = `linear-gradient(180deg, ${backgroundColor} 0%, #1a1a2e 100%)`;

      document.querySelectorAll('.btn').forEach(btn => {
        btn.style.background = primaryColor;
      });

      document.querySelectorAll('.answer-btn').forEach(btn => {
        if (!btn.classList.contains('correct') && !btn.classList.contains('wrong')) {
          btn.style.background = secondaryColor;
        }
      });

      document.querySelectorAll('.title').forEach(title => {
        title.style.color = accentColor;
      });

      document.querySelector('.stage-indicator').style.color = secondaryColor;
      document.querySelector('.score-display').style.color = accentColor;

      const customFont = config.font_family || defaultConfig.font_family;
      const baseFontStack = 'Courier New, monospace';
      const fontFamily = `${customFont}, ${baseFontStack}`;
      
      document.body.style.fontFamily = fontFamily;
      document.querySelectorAll('.btn, .answer-btn').forEach(el => {
        el.style.fontFamily = fontFamily;
      });

      const baseSize = config.font_size || defaultConfig.font_size;
      document.querySelector('.title').style.fontSize = `${baseSize * 3}px`;
      document.querySelector('.subtitle').style.fontSize = `${baseSize * 1.25}px`;
      document.querySelectorAll('.btn').forEach(btn => {
        btn.style.fontSize = `${baseSize * 1.25}px`;
      });
      document.querySelector('.question-box').style.fontSize = `${baseSize * 1.125}px`;
      document.querySelectorAll('.answer-btn').forEach(btn => {
        btn.style.fontSize = `${baseSize}px`;
      });
      document.querySelector('.score-display').style.fontSize = `${baseSize * 2.25}px`;
      document.querySelector('.stage-indicator').style.fontSize = `${baseSize * 1.5}px`;
    }

    if (window.elementSdk) {
      window.elementSdk.init({
        defaultConfig,
        onConfigChange,
        mapToCapabilities: (config) => ({
          recolorables: [
            {
              get: () => config.background_color || defaultConfig.background_color,
              set: (value) => {
                config.background_color = value;
                window.elementSdk.setConfig({ background_color: value });
              }
            },
            {
              get: () => config.primary_color || defaultConfig.primary_color,
              set: (value) => {
                config.primary_color = value;
                window.elementSdk.setConfig({ primary_color: value });
              }
            },
            {
              get: () => config.secondary_color || defaultConfig.secondary_color,
              set: (value) => {
                config.secondary_color = value;
                window.elementSdk.setConfig({ secondary_color: value });
              }
            },
            {
              get: () => config.accent_color || defaultConfig.accent_color,
              set: (value) => {
                config.accent_color = value;
                window.elementSdk.setConfig({ accent_color: value });
              }
            },
            {
              get: () => config.text_color || defaultConfig.text_color,
              set: (value) => {
                config.text_color = value;
                window.elementSdk.setConfig({ text_color: value });
              }
            }
          ],
          borderables: [],
          fontEditable: {
            get: () => config.font_family || defaultConfig.font_family,
            set: (value) => {
              config.font_family = value;
              window.elementSdk.setConfig({ font_family: value });
            }
          },
          fontSizeable: {
            get: () => config.font_size || defaultConfig.font_size,
            set: (value) => {
              config.font_size = value;
              window.elementSdk.setConfig({ font_size: value });
            }
          }
        }),
        mapToEditPanelValues: (config) => new Map([
          ["game_title", config.game_title || defaultConfig.game_title],
          ["welcome_message", config.welcome_message || defaultConfig.welcome_message],
          ["start_button_text", config.start_button_text || defaultConfig.start_button_text]
        ])
      });
    }
  </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'99ce248a87ee7d63',t:'MTc2Mjg2NzgxMS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
